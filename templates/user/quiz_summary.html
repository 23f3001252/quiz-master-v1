{% extends '/user/layout2.html' %}

{% block title %}Quiz Summary{% endblock %}

{% block style %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
    <h2 style="padding: 15px;">Welcome {{ username }}</h2>
    <div class="container mt-4">
        <h3 class="text-center" style="background-color: rgb(104, 159, 211); color: black; padding: 10px; border-radius: 1rem;">Summary Charts</h3>

        <div class="row">
            <div class="col-md-6">
                <h5>Subject wise no. of quizzes</h5>
                <canvas id="subjectChart"></canvas>
            </div>

            <div class="col-md-6">
                <h5>Month wise no. of quizzes attempted</h5>
                <canvas id="monthChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        const subjectData = {{ subject_data|tojson|safe }};
        const monthData = {{ month_data|tojson|safe }};

        const subjectLabels = subjectData.map(item => item.subject);
        const subjectCounts = subjectData.map(item => item.count);

        new Chart(document.getElementById('subjectChart'), {
            type: 'bar',
            data: {
                labels: subjectLabels,
                datasets: [{
                    label: 'Number of Quizzes',
                    data: subjectCounts,
                    backgroundColor: ['#74b9ff', '#55efc4', '#fab1a0']
                }]
            }
        });

        const monthLabels = monthData.map(item => item.month);
        const monthCounts = monthData.map(item => item.count);

        new Chart(document.getElementById('monthChart'), {
            type: 'pie',
            data: {
                labels: monthLabels,
                datasets: [{
                    label: 'Quizzes Attempted',
                    data: monthCounts,
                    backgroundColor: ['#ff7675', '#fdcb6e', '#6c5ce7']
                }]
            }
        });
    </script>
{% endblock %}
